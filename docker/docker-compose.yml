version: '3.8'

services:
  rn2:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: rn2
    restart: unless-stopped
    privileged: true
    ports:
      - "8080:80"
    devices:
      - /dev/bus/usb:/dev/bus/usb
    volumes:
      # Externalize settings.yml for easy editing on host
      - ./config/settings.yml:/home/pi/raspberry-noaa-v2/config/settings.yml:rw
      # Externalize all media files to host machine
      - ./data/images:/srv/images:rw
      - ./data/videos:/srv/videos:rw
      - ./data/audio:/srv/audio:rw
      # Persist database and other data
      - ./data/db:/home/pi/raspberry-noaa-v2/db:rw
      - ./data/logs:/var/log/raspberry-noaa-v2:rw
      - ./data/tmp:/home/pi/raspberry-noaa-v2/tmp:rw
    environment:
      - TZ=Europe/London
    networks:
      - rn2-network

networks:
  rn2-network:
    driver: bridge
